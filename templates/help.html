{% extends "base.html" %}

{% block title %}Ayuda - Copiloto de Supervivencia{% endblock %}

{% block content %}
<div class="help-page">
    <div class="page-header">
        <h2>‚ùì Ayuda y Gu√≠a de Uso</h2>
    </div>

    <div class="help-section">
        <h3>üöÄ C√≥mo Funciona</h3>
        <p>El <strong>Copiloto de Supervivencia Financiera</strong> analiza tus datos financieros para:</p>
        <ol>
            <li>Calcular una proyecci√≥n de caja fiable (cashflow determinista)</li>
            <li>Determinar cu√°nto capital necesitas para sobrevivir X meses</li>
            <li>Distinguir entre capital estructural y financiaci√≥n puente</li>
            <li>Evaluar si tu l√≠nea de cr√©dito es suficiente</li>
            <li>Generar escenarios "qu√© pasa si..."</li>
            <li>Crear alertas accionables y plan de acci√≥n priorizado</li>
            <li>Producir informe ejecutivo interpretado por IA (con anti-alucinaci√≥n)</li>
        </ol>
        <p><strong>Principio clave:</strong> Python calcula n√∫meros, la IA solo interpreta. Cero alucinaciones en cifras.</p>
    </div>

    <div class="help-section" id="templates">
        <h3>üìÅ Formatos de Archivos</h3>
        
        <h4>1. Extracto Bancario (OBLIGATORIO)</h4>
        <p>CSV o Excel con columnas:</p>
        <ul>
            <li><code>Fecha</code> o <code>Date</code>: fecha de la transacci√≥n (DD/MM/YYYY o YYYY-MM-DD)</li>
            <li><code>Importe</code> o <code>Amount</code>: importe (positivo=ingreso, negativo=pago)</li>
            <li>O bien: <code>D√©bito</code> y <code>Cr√©dito</code> en columnas separadas</li>
            <li><code>Concepto</code> o <code>Description</code>: descripci√≥n (opcional)</li>
        </ul>
        <p><strong>Ejemplo:</strong></p>
        <pre>
Fecha,Importe,Concepto
15/01/2025,1500.00,Cobro cliente ABC
18/01/2025,-850.50,Pago proveedor XYZ
20/01/2025,3200.00,Transferencia cliente DEF
        </pre>

        <h4>2. Facturas Emitidas (OPCIONAL pero recomendado)</h4>
        <p>CSV o Excel con columnas:</p>
        <ul>
            <li><code>ID</code> o <code>N√∫mero</code>: identificador de factura</li>
            <li><code>Cliente</code> o <code>Customer</code>: nombre del cliente</li>
            <li><code>Fecha emisi√≥n</code> o <code>Issue Date</code>: fecha de emisi√≥n</li>
            <li><code>Fecha vencimiento</code> o <code>Due Date</code>: fecha de vencimiento</li>
            <li><code>Importe</code> o <code>Amount</code>: importe total</li>
            <li><code>Estado</code> o <code>Status</code>: paid/unpaid/overdue (opcional)</li>
        </ul>
        <p><strong>Ejemplo:</strong></p>
        <pre>
ID,Cliente,Fecha emisi√≥n,Fecha vencimiento,Importe,Estado
F001,Empresa A,10/01/2025,10/02/2025,2500.00,unpaid
F002,Empresa B,15/01/2025,15/03/2025,4800.00,unpaid
        </pre>

        <h4>3. Facturas Recibidas (OPCIONAL)</h4>
        <p>Similar a Facturas Emitidas, pero con <code>Proveedor</code> o <code>Supplier</code> en lugar de Cliente.</p>

        <h4>üì• Descargar Plantillas</h4>
        <p>Las plantillas CSV est√°n disponibles en <code>exports/templates/</code> en el repositorio.</p>
    </div>

    <div class="help-section">
        <h3>üéØ Consejos para Mejores Resultados</h3>
        <ul>
            <li><strong>Extracto completo:</strong> Sube al menos 3-6 meses de movimientos bancarios</li>
            <li><strong>Facturas pendientes:</strong> Incluye todas las facturas emitidas y recibidas no pagadas</li>
            <li><strong>Gastos fijos:</strong> Proporciona la cifra mensual de costes recurrentes</li>
            <li><strong>L√≠nea de cr√©dito:</strong> Incluye esta info para an√°lisis m√°s preciso</li>
            <li><strong>Modo conservador:</strong> Act√≠valo si tus clientes suelen pagar con retraso</li>
        </ul>
    </div>

    <div class="help-section">
        <h3>üìä Interpretando los Resultados</h3>
        
        <h4>Nivel de Confianza</h4>
        <ul>
            <li><strong>Alta:</strong> Datos completos (extracto + facturas + 6+ meses)</li>
            <li><strong>Media:</strong> Datos parciales o cobertura 3-6 meses</li>
            <li><strong>Baja:</strong> Datos limitados o < 3 meses</li>
        </ul>

        <h4>Nivel de Riesgo</h4>
        <ul>
            <li><strong>High:</strong> Balance proyectado caer√° por debajo de 0‚Ç¨</li>
            <li><strong>Medium:</strong> Balance por debajo del umbral de seguridad</li>
            <li><strong>Low:</strong> Balance saludable durante todo el horizonte</li>
        </ul>

        <h4>Capital Necesario</h4>
        <ul>
            <li><strong>Capital Propio:</strong> Buffer estructural (colch√≥n m√≠nimo recomendado)</li>
            <li><strong>Financiaci√≥n Puente:</strong> Cr√©dito temporal para cubrir picos de d√©ficit</li>
            <li><strong>Brecha:</strong> Dinero adicional necesario si tu l√≠nea de cr√©dito no es suficiente</li>
        </ul>
    </div>

    <div class="help-section">
        <h3>üîí Privacidad y Seguridad</h3>
        <p>Tus datos se procesan <strong>localmente</strong> en tu servidor. No se env√≠an a servicios externos excepto:</p>
        <ul>
            <li>API de IA (Claude/OpenAI) SOLO para generar interpretaci√≥n del informe (sin datos bancarios crudos)</li>
            <li>Puedes usar el modo "rules-based" sin API key para m√°xima privacidad</li>
        </ul>
        <p>Los an√°lisis se guardan en <code>data/history/</code> en JSON.</p>
    </div>

    <div class="help-section">
        <h3>üêõ Problemas Comunes</h3>
        
        <h4>Error "Columna de fecha no encontrada"</h4>
        <p>Aseg√∫rate de que tu CSV tiene una columna llamada "Fecha" o "Date" (no sensible a may√∫sculas).</p>

        <h4>Alertas "filas inv√°lidas eliminadas"</h4>
        <p>Normal. El parser elimina filas con fechas o importes vac√≠os. Revisa tu archivo si pierdes muchas filas.</p>

        <h4>Informe "rules-based" en lugar de IA</h4>
        <p>No se encontr√≥ API key. Configura <code>ANTHROPIC_API_KEY</code> o <code>OPENAI_API_KEY</code> en variables de entorno.</p>

        <h4>Escenario conservador "limitado"</h4>
        <p>No hay datos de cobros futuros (facturas emitidas). El escenario conservador necesita facturas pendientes.</p>
    </div>

    <div class="help-section">
        <h3>üìû Soporte</h3>
        <p>Para bugs o sugerencias, revisa el <code>README.md</code> del repositorio.</p>
    </div>

    <div class="help-actions">
        <a href="{{ url_for('index') }}" class="btn btn-primary">üöÄ Comenzar An√°lisis</a>
    </div>
</div>
{% endblock %}
